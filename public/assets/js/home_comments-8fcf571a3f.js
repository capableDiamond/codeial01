let createCommentForm=$(".comment-form");for(i of createCommentForm)i.addEventListener("submit",e=>{handleCommentCreation(e)});function handleCommentCreation(e){e.preventDefault(),$.ajax({type:"post",url:"/comments/create",data:$(e.target).serialize(),success:function(e){let t=newCommentDom(e.data.comment);$("#post-comments-"+e.data.comment.post._id).prepend(t),handleCommentDeletion($("#delete-button-"+e.data.comment._id)),$("#like-comment-"+comment._id).click((function(e){handleLike(e)})),new Noty({theme:"relax",text:"Comment Published",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}let newCommentDom=function(e){return $(`<li id='comment-${e._id}'>\n            <p>\n                <a href="/comments/destroy/${e._id}" class="delete-comment-button" id="delete-button-${e._id}">X</a>\n                ${e.content}\n                <br>\n                <small>\n                    ${e.user.name}\n                </small>\n            </p>\n            <div class="like" id="like-comment-${e._id}">\n                <p>${e.likes.length}</p>\n                <a href="/likes/toggle/?id=${e._id}&type=Comment" class="like-link">\n                    \x3c!-- check for post id in liked by user to see if the post has been liked by user --\x3e\n                    <i class="fa-regular fa-heart" style="color: #000000;"></i>\n                    Like\n                </a>\n            </div>\n        </li>`)};function handleCommentDeletion(e){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$("#comment-"+e.data.commentId).remove(),new Noty({theme:"relax",text:"Comment Deleted",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))}function handleLike(e){e.preventDefault(),$.ajax({type:"get",url:e.target.href,success:function(t){let n=e.target.href.split("=").pop().toLowerCase(),o=e.target.href.split("=")[1];o=o.split("&")[0],t.data.deleted?($(`#like-${n}-${o} p`).html(t.data.length),$(`#like-${n}-${o} a i`).toggleClass("fa-solid fa-regular"),$(`#like-${n}-${o} a i`).css("color","#000000")):($(`#like-${n}-${o} p`).html(t.data.length),$(`#like-${n}-${o} a i`).toggleClass("fa-regular fa-solid"),$(`#like-${n}-${o} a i`).css("color","#ff0000"))}})}