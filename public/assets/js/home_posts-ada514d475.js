{let e=function(){let e=$("#new-post-form");e.submit((function(o){o.preventDefault(),$.ajax({type:"post",url:"/posts/create",data:e.serialize(),success:function(e){let o=t(e.data.post);$("#post-lists-container > ul").prepend(o),n($(" .delete-post-button",o)),$(`#comment-form-${e.data.post._id}`).submit((function(e){e.preventDefault(),handleCommentCreation(e,o)})),$(`#like-post-${e.data.post._id}`).click((function(e){handleLike(e)})),new Noty({theme:"relax",text:"Post Created",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},t=function(e){return $(`<li id="post-${e._id}" class="post">\n        <p>\n            <small>\n                <a class="delete-post-button" href="/posts/destroy/${e._id}">X</a>\n            </small>\n    \n            ${e.content} \n            <br>\n            <small>\n                by ${e.user.name}\x3c!-- //this does not work as it has not been populated yet --\x3e\n            </small>\n        </p>\n\n        <div class="like" id="like-post-${e._id}">\n            <p>${e.likes.length}</p>\n            <a href="/likes/toggle/?id=${e._id}&type=Post" class="like-link">\n                <i class="fa-regular fa-heart" style="color: #000000;"></i>\n                Like\n            </a>\n        </div>\n\n        <div class="post-comments">\n            \n            <form action="/comments/create" method="post" class='comment-form' id='comment-form-${e._id}'>\n                <input type="text" name="content" placeholder="Type Here to add Comment ..." required>\n                <input type="hidden" name="post" value="${e._id}">\n                <input type="submit" value="Add Comment">\n            </form>\n    \n            <div class="post-comments-list">\n                <ul id="post-comments-${e._id}">\n                </ul>\n            </div>\n    \n        </div>\n    </li>`)},n=function(e){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#post-${e.data.post_id}`).remove(),new Noty({theme:"relax",text:"Post Deleted",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))};function handleCommentCreation(e,t){$.ajax({type:"post",url:"/comments/create",data:$(e.target).serialize(),success:function(e){let n=o(e.data.comment);$(" .post-comments-list",t).prepend(n),handleCommentDeletion($(`#delete-button-${e.data.comment._id}`)),$(`#like-comment-${e.data.comment._id}`).click((function(e){handleLike(e)}))},error:function(e){console.log(e.responseText)}})}e();let o=function(e){return $(`<li id='comment-${e._id}'>\n                <p>\n                    <a href="/comments/destroy/${e._id}" class='delete-comment-button' id="delete-button-${e._id}">X</a>\n                    ${e.content}\n                    <br>\n                    <small>\n                        ${e.user.name}\n                    </small>\n                </p>\n                <div class="like" id="like-comment-${e._id}">\n                    <p>${e.likes.length}</p>\n                    <a href="/likes/toggle/?id=${e._id}&type=Comment" class="like-link">\n                        \x3c!-- check for post id in liked by user to see if the post has been liked by user --\x3e\n                        <i class="fa-regular fa-heart" style="color: #000000;"></i>\n                        Like\n                    </a>\n                </div>\n            </li>`)};function handleCommentDeletion(e){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#comment-${e.data.commentId}`).remove()},error:function(e){console.log(e.responseText)}})}))}function handleLike(e){console.log("handled"),e.preventDefault(),$.ajax({type:"get",url:e.target.href,success:function(t){let n=e.target.href.split("=").pop().toLowerCase(),o=e.target.href.split("=")[1];o=o.split("&")[0],t.data.deleted?($(`#like-${n}-${o} p`).html(t.data.length),$(`#like-${n}-${o} a i`).toggleClass("fa-solid fa-regular"),$(`#like-${n}-${o} a i`).css("color","#000000")):($(`#like-${n}-${o} p`).html(t.data.length),$(`#like-${n}-${o} a i`).toggleClass("fa-regular fa-solid"),$(`#like-${n}-${o} a i`).css("color","#ff0000"))}})}}